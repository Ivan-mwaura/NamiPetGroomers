import{g as D,d as P,s as N,K as b,L as v,r as l,h as S,i as w,j as e,_ as y,l as T,m as k,b as E,E as F,G as I,H as A,T as m,M,I as R,J as g,a as x,B as d}from"./index-CJpKQtVr.js";import{i as B}from"./pricing-2-DwiU3LKj.js";function W(s){return D("MuiDialogContentText",s)}P("MuiDialogContentText",["root"]);const H=["children","className"],U=s=>{const{classes:o}=s,n=k({root:["root"]},W,o);return y({},o,n)},_=N(b,{shouldForwardProp:s=>v(s)||s==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(s,o)=>o.root})({}),L=l.forwardRef(function(o,c){const n=S({props:o,name:"MuiDialogContentText"}),{className:u}=n,r=w(n,H),i=U(r);return e.jsx(_,y({component:"p",variant:"body1",color:"text.secondary",ref:c,ownerState:r,className:T(i.root,u)},n,{classes:i}))}),O=()=>{const[s,o]=l.useState(null),[c,n]=l.useState(!1),[u,r]=l.useState(""),[i,j]=l.useState({name:"",phoneNumber:"",email:""}),p=E(t=>t.pet.subscriptionId);console.log("subscriptionId:",p),l.useEffect(()=>{(async()=>{try{const a=await x.get(`http://localhost:5000/api/v1/getPricing/${p}`);o(a.data.data)}catch(a){console.error("Error fetching subscription details:",a)}})()},[p]);const h=t=>{const{name:a,value:C}=t.target;j({...i,[a]:C})};if(!s)return e.jsx("div",{children:"Loading..."});const f=async()=>{try{await x.post("http://localhost:5000/api/v1/sendSubscribeReply",{name:i.name,phoneNumber:`254${i.phoneNumber}`,email:i.email,amount:s.pricingPrice,subscriptionPlan:s.pricingName}).then(t=>{t.status===200&&d.success("Hello, you have successfully subscribed to our service. We will get back to you soon.")}).catch(t=>{console.log("Error sending reply:",t),d.error("Failed to subscribe. Please try again later.")});try{await x.post("http://localhost:5000/api/v1/payment",{phone:`254${i.phoneNumber}`,amount:s.pricingPrice}).then(t=>{t.status===200&&(r("Payment initiated successfully. Check your phone."),d.success("Payment initiated successfully. Check your phone."))}),r("Payment initiated successfully. Check your phone.")}catch{r("Failed to initiate payment")}n(!1)}catch{d.error("Failed to subscribe. Please try again later.")}};return e.jsxs("div",{className:"subscription-details",children:[e.jsxs("div",{className:"subscription-card",children:[e.jsx("img",{src:s.image||B,alt:s.pricingName}),e.jsxs("h2",{children:[s.pricingName," Plan"]}),e.jsxs("h3",{children:[s.pricingPrice," ",e.jsx("span",{children:"Ksh/mo"})]}),e.jsx("p",{children:s.pricingDescription}),e.jsx("h4",{children:"Benefits:"}),e.jsx("ul",{children:s.PricingBenefits.map((t,a)=>e.jsx("li",{children:t},a))})]}),e.jsxs("div",{className:"additional-details",children:[e.jsx("h3",{children:"How it works"}),e.jsx("p",{children:"Here you can add detailed information about how the subscription works, any special instructions, or additional benefits that users will get."}),e.jsx("h4",{children:"Additional Benefits:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"24/7 Customer Support"}),e.jsx("li",{children:"Access to premium features"}),e.jsx("li",{children:"Monthly newsletters"}),e.jsx("li",{children:"Special discounts on other services"})]})]}),e.jsx("div",{className:"call-to-action",children:e.jsx("button",{onClick:()=>n(!0),children:"Subscribe"})}),e.jsxs(F,{open:c,onClose:()=>n(!1),children:[e.jsx(I,{children:"Payment"}),e.jsxs(A,{children:[e.jsx(L,{children:"Enter your name, phone number, and email address to subscribe."}),e.jsx(m,{margin:"dense",id:"name",label:"Name",type:"text",fullWidth:!0,name:"name",value:i.name,onChange:h}),e.jsx(m,{autoFocus:!0,margin:"dense",id:"phoneNumber",label:"Phone Number",type:"text",fullWidth:!0,name:"phoneNumber",value:i.phoneNumber,onChange:h,InputProps:{startAdornment:e.jsx(M,{position:"start",children:"+254"})}}),e.jsx(m,{margin:"dense",id:"email",label:"Email Address",type:"email",fullWidth:!0,name:"email",value:i.email,onChange:h}),u&&e.jsx(b,{color:"error",children:u})]}),e.jsxs(R,{children:[e.jsx(g,{onClick:()=>n(!1),color:"primary",children:"Cancel"}),e.jsx(g,{onClick:f,color:"primary",children:"Pay"})]})]})]})};export{O as default};
