import{d as F,e as _,k as B,s as N,f as x,_ as y,h as A,r as g,u as q,i as W,j as t,l as O,m as H,S as J,n as V,o as Z,p as Q,q as Y,T as X,t as T,A as I,b as P,P as S,F as ee,v as te}from"./index.js";import{a as $,C as M}from"./CustomButton.js";import{M as j}from"./MenuItem.js";/* empty css      */import{A as re}from"./Avatar.js";function se(e){return F("MuiCircularProgress",e)}_("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const ae=["className","color","disableShrink","size","style","thickness","value","variant"];let R=e=>e,z,U,L,E;const w=44,ie=B(z||(z=R`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),oe=B(U||(U=R`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),ne=e=>{const{classes:r,variant:s,color:o,disableShrink:n}=e,l={root:["root",s,`color${x(o)}`],svg:["svg"],circle:["circle",`circle${x(s)}`,n&&"circleDisableShrink"]};return H(l,se,r)},le=N("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.root,r[s.variant],r[`color${x(s.color)}`]]}})(({ownerState:e,theme:r})=>y({display:"inline-block"},e.variant==="determinate"&&{transition:r.transitions.create("transform")},e.color!=="inherit"&&{color:(r.vars||r).palette[e.color].main}),({ownerState:e})=>e.variant==="indeterminate"&&A(L||(L=R`
      animation: ${0} 1.4s linear infinite;
    `),ie)),ce=N("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,r)=>r.svg})({display:"block"}),de=N("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.circle,r[`circle${x(s.variant)}`],s.disableShrink&&r.circleDisableShrink]}})(({ownerState:e,theme:r})=>y({stroke:"currentColor"},e.variant==="determinate"&&{transition:r.transitions.create("stroke-dashoffset")},e.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink&&A(E||(E=R`
      animation: ${0} 1.4s ease-in-out infinite;
    `),oe)),G=g.forwardRef(function(r,s){const o=q({props:r,name:"MuiCircularProgress"}),{className:n,color:l="primary",disableShrink:a=!1,size:p=40,style:c,thickness:u=3.6,value:i=0,variant:d="indeterminate"}=o,v=W(o,ae),b=y({},o,{color:l,disableShrink:a,size:p,thickness:u,value:i,variant:d}),k=ne(b),f={},D={},m={};if(d==="determinate"){const C=2*Math.PI*((w-u)/2);f.strokeDasharray=C.toFixed(3),m["aria-valuenow"]=Math.round(i),f.strokeDashoffset=`${((100-i)/100*C).toFixed(3)}px`,D.transform="rotate(-90deg)"}return t.jsx(le,y({className:O(k.root,n),style:y({width:p,height:p},D,c),ownerState:b,ref:s,role:"progressbar"},m,v,{children:t.jsx(ce,{className:k.svg,ownerState:b,viewBox:`${w/2} ${w/2} ${w} ${w}`,children:t.jsx(de,{className:k.circle,style:f,ownerState:b,cx:w,cy:w,r:(w-u)/2,fill:"none",strokeWidth:u})})}))});function ue(e){return F("MuiSwitch",e)}const h=_("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),pe=["className","color","edge","size","sx"],he=Y(),ve=e=>{const{classes:r,edge:s,size:o,color:n,checked:l,disabled:a}=e,p={root:["root",s&&`edge${x(s)}`,`size${x(o)}`],switchBase:["switchBase",`color${x(n)}`,l&&"checked",a&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},c=H(p,ue,r);return y({},r,c)},fe=N("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.root,s.edge&&r[`edge${x(s.edge)}`],r[`size${x(s.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${h.thumb}`]:{width:16,height:16},[`& .${h.switchBase}`]:{padding:4,[`&.${h.checked}`]:{transform:"translateX(16px)"}}}}]}),ge=N(J,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.switchBase,{[`& .${h.input}`]:r.input},s.color!=="default"&&r[`color${x(s.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${h.checked}`]:{transform:"translateX(20px)"},[`&.${h.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${h.checked} + .${h.track}`]:{opacity:.5},[`&.${h.disabled} + .${h.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${h.input}`]:{left:"-100%",width:"300%"}}),({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:V(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{color:r},style:{[`&.${h.checked}`]:{color:(e.vars||e).palette[r].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[r].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:V(e.palette[r].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${h.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${r}DisabledColor`]:`${e.palette.mode==="light"?Z(e.palette[r].main,.62):Q(e.palette[r].main,.55)}`}},[`&.${h.checked} + .${h.track}`]:{backgroundColor:(e.vars||e).palette[r].main}}}))]})),me=N("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,r)=>r.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),xe=N("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,r)=>r.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),be=g.forwardRef(function(r,s){const o=he({props:r,name:"MuiSwitch"}),{className:n,color:l="primary",edge:a=!1,size:p="medium",sx:c}=o,u=W(o,pe),i=y({},o,{color:l,edge:a,size:p}),d=ve(i),v=t.jsx(xe,{className:d.thumb,ownerState:i});return t.jsxs(fe,{className:O(d.root,n),sx:c,ownerState:i,children:[t.jsx(ge,y({type:"checkbox",icon:v,checkedIcon:v,ref:s,ownerState:i},u,{classes:y({},d,{root:d.switchBase})})),t.jsx(me,{className:d.track,ownerState:i})]})}),ye=({user:e,setUser:r,loading:s,error:o})=>{const[n,l]=g.useState(!1),[a,p]=g.useState(e),[c,u]=g.useState({open:!1,message:"",severity:""}),i=f=>{const{name:D,value:m}=f.target;p(C=>({...C,[D]:m}))},d=()=>{l(!0),p(e)},v=()=>{l(!1),p(e)},b=async()=>{try{const f=await P.patch(`http://localhost:3008/users/${e._id}`,a);f.status===200?(r(f.data),l(!1),u({open:!0,message:"User updated successfully.",severity:"success"}),setTimeout(()=>{window.location.reload()},2e3)):(console.error("Unexpected response status:",f.status),u({open:!0,message:"Unexpected response status.",severity:"error"}))}catch(f){console.error("Failed to update user:",f.message),u({open:!0,message:"Failed to update user.",severity:"error"})}},k=()=>{u({...c,open:!1})};return s?t.jsx("div",{className:"Loading",children:t.jsx(G,{})}):o?t.jsxs(X,{color:"error",children:["Error: ",o]}):t.jsxs("div",{className:"UserRight DisplayFlex",children:[t.jsx("span",{children:"User Details"}),t.jsxs("div",{className:"UserDetails DisplayFlex",children:[t.jsx($,{id:"name",label:"Name",name:"name",type:"text",variant:"outlined",value:(a==null?void 0:a.name)||"",onChange:i,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!n}),t.jsx($,{id:"phone",label:"Phone",name:"phone",type:"text",variant:"outlined",value:(a==null?void 0:a.phone)||"",onChange:i,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!n})]}),t.jsxs("div",{className:"UserDetails DisplayFlex",children:[t.jsx($,{id:"email",label:"Email",name:"email",type:"text",variant:"outlined",value:(a==null?void 0:a.email)||"",onChange:i,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!n}),t.jsxs($,{id:"userType",label:"Role",name:"userType",variant:"outlined",value:(a==null?void 0:a.userType)||"",onChange:i,fullWidth:!0,InputLabelProps:{shrink:!0},select:!0,disabled:!n,children:[t.jsx(j,{value:"admin",children:"Admin"}),t.jsx(j,{value:"user",children:"User"}),t.jsx(j,{value:"moderator",children:"Moderator"}),t.jsx(j,{value:"subscriber",children:"Subscriber"}),t.jsx(j,{value:"guest",children:"Guest"})]})]}),t.jsxs("div",{className:"UserDetails DisplayFlex",children:[t.jsxs($,{id:"status",label:"Status",name:"status",variant:"outlined",value:(a==null?void 0:a.verificationStatus)||"",onChange:i,fullWidth:!0,InputLabelProps:{shrink:!0},select:!0,disabled:!n,children:[t.jsx(j,{value:"verified",children:"Verified"}),t.jsx(j,{value:"pending",children:"Pending"}),t.jsx(j,{value:"terminated",children:"Terminated"})]}),t.jsx($,{id:"joined",label:"Joined",variant:"outlined",value:new Date(e==null?void 0:e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})||"",disabled:!0,fullWidth:!0,InputLabelProps:{shrink:!0}})]}),t.jsx("div",{className:"UserDetails DisplayFlex",children:t.jsx($,{id:"description",label:"Description",name:"description",variant:"outlined",value:(a==null?void 0:a.description)||"",onChange:i,fullWidth:!0,InputLabelProps:{shrink:!0},multiline:!0,rows:4,disabled:!n})}),t.jsx("div",{className:"UserButtons DisplayFlex",children:n?t.jsxs(t.Fragment,{children:[t.jsx(M,{text:"Cancel",variant:"outlined",onClick:v,size:"small",sx:{marginRight:"10px",color:"var(--error-light)",border:"1.5px solid var(--error-light)","&:hover":{backgroundColor:"transparent !important",color:"var(--error-dark)",border:"1.5px solid var(--error-dark)"}}}),t.jsx(M,{text:"Update",variant:"contained",onClick:b,size:"small",sx:{color:"#fff",backgroundColor:"var(--success-darker)","&:hover":{backgroundColor:"var(--success-dark) !important",color:"var(--success-lighter)"}}})]}):t.jsx(M,{text:"Edit User",variant:"outlined",onClick:d,sx:{marginRight:"10px",color:"var(--primary-dark)",border:"1.5px solid var(--primary-dark)",Transition:"all 0.3s ease-in-out","&:hover":{backgroundColor:"transparent !important",color:"var(--primary-light)",border:"1.5px solid var(--primary-light)"}},size:"small"})}),t.jsx(T,{open:c.open,autoHideDuration:6e3,onClose:k,children:t.jsx(I,{onClose:k,severity:c.severity,sx:{width:"100%"},children:c.message})})]})},ke=N(e=>t.jsx(be,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...e}))(({theme:e})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:e.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:e.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:e.palette.mode==="light"?"#E9E9EA":"#39393D",opacity:1,transition:e.transitions.create(["background-color"],{duration:500})}})),K=({user:e,loading:r,error:s,handleVerificationToggle:o,showVerificationInput:n,verificationCode:l,setVerificationCode:a,handleVerifyCode:p})=>{const[c,u]=g.useState({open:!1,message:"",severity:""}),i=()=>{u({...c,open:!1})};return r?t.jsx("div",{className:"Loading",children:t.jsx(G,{})}):s?t.jsxs(X,{color:"error",children:["Error: ",s]}):e?t.jsxs("div",{className:"UserLeft DisplayFlex",children:[t.jsx(re,{src:e.profilePicture,alt:e.name,style:{width:"8rem",height:"8rem"}}),t.jsxs("span",{children:[e.name," ",e.verificationStatus==="verified"&&t.jsx("i",{className:"fas fa-check-circle"})]}),t.jsx("p",{children:e.email}),t.jsxs("p",{children:[t.jsx("strong",{children:"Role:"})," ",e.userType]}),t.jsx("p",{children:new Date(e.lastLogin).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}),t.jsx(ee,{control:t.jsx(ke,{checked:e.verificationStatus==="verified",onChange:o,disabled:e.verificationStatus==="verified"}),label:e.verificationStatus==="verified"?"Verified":"Verify",style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1rem",fontSize:"0.8rem !important",fontWeight:"400 !important"}}),n&&t.jsx("div",{className:"VerificationInput",children:t.jsx($,{placeholder:"Verification Code",value:l,onChange:d=>a(d.target.value),type:"text",variant:"outlined",InputProps:{endAdornment:t.jsx(M,{onClick:p,variant:"contained",color:"primary",size:"small",text:"Verify",disabled:r})}})}),t.jsx(T,{open:c.open,autoHideDuration:6e3,onClose:i,children:t.jsx(I,{onClose:i,severity:c.severity,sx:{width:"100%"},children:c.message})})]}):t.jsx("div",{children:"No user data available"})};K.propTypes={user:S.object,loading:S.bool,error:S.string,handleVerificationToggle:S.func,showVerificationInput:S.bool,verificationCode:S.string,setVerificationCode:S.func,handleVerifyCode:S.func};const Ne=()=>{const{id:e}=te(),[r,s]=g.useState(null),[o,n]=g.useState(!0),[l,a]=g.useState(null),[p,c]=g.useState(!1),[u,i]=g.useState(""),[d,v]=g.useState({open:!1,message:"",severity:""}),b=async()=>{try{const m=await P.get(`http://localhost:3008/users/${e}`);s(m.data),n(!1)}catch(m){a(m.message),n(!1)}};g.useEffect(()=>{b()},[e]);const k=async m=>{if(m.target.checked){c(!0);try{(await P.post("http://localhost:3008/users/send-verification",{email:r.email})).status===200?v({open:!0,message:"Verification link has been sent to your email.",severity:"success"}):v({open:!0,message:"Failed to send verification link.",severity:"error"})}catch{v({open:!0,message:"Failed to send verification link.",severity:"error"})}}},f=async()=>{try{(await P.post("http://localhost:3008/users/verify-code",{email:r.email,code:u})).status===200?(s(C=>({...C,verificationStatus:"verified"})),c(!1),v({open:!0,message:"Verification successful.",severity:"success"})):v({open:!0,message:"Verification failed.",severity:"error"})}catch{v({open:!0,message:"Verification failed.",severity:"error"})}},D=()=>{v({...d,open:!1})};return o?t.jsx("div",{className:"Loading",children:t.jsx("div",{className:"Spinner"})}):l?t.jsxs("div",{children:["Error: ",l]}):r?t.jsxs("div",{className:"User",children:[t.jsxs("div",{className:"UserContainer",children:[t.jsx(K,{user:r,fetchUser:b,loading:o,error:l,handleVerificationToggle:k,showVerificationInput:p,verificationCode:u,setVerificationCode:i,handleVerifyCode:f}),t.jsx(ye,{user:r,setUser:s,loading:o,error:l})]}),t.jsx(T,{open:d.open,autoHideDuration:6e3,onClose:D,children:t.jsx(I,{onClose:D,severity:d.severity,sx:{width:"100%"},children:d.message})})]}):t.jsx("div",{children:"No user data available"})};export{Ne as default};
