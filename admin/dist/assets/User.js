import{d as R,e as U,s as w,f as k,S as E,h as z,l as F,i as B,r as h,_ as A,k as N,j as t,m as W,n as _,o as O,T as I,p as T,A as V,b as D,P as x,F as H,u as X}from"./index.js";import{C as y}from"./CustomTextField.js";import{C as M}from"./CustomButton.js";import{C as L}from"./CircularProgress.js";import{M as b}from"./MenuItem.js";/* empty css      */import{A as G}from"./Avatar.js";function J(e){return U("MuiSwitch",e)}const l=R("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),q=["className","color","edge","size","sx"],K=_(),Q=e=>{const{classes:a,edge:i,size:c,color:o,checked:d,disabled:s}=e,v={root:["root",i&&`edge${k(i)}`,`size${k(c)}`],switchBase:["switchBase",`color${k(o)}`,d&&"checked",s&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},n=O(v,J,a);return N({},a,n)},Y=w("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:i}=e;return[a.root,i.edge&&a[`edge${k(i.edge)}`],a[`size${k(i.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${l.thumb}`]:{width:16,height:16},[`& .${l.switchBase}`]:{padding:4,[`&.${l.checked}`]:{transform:"translateX(16px)"}}}}]}),Z=w(E,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,a)=>{const{ownerState:i}=e;return[a.switchBase,{[`& .${l.input}`]:a.input},i.color!=="default"&&a[`color${k(i.color)}`]]}})(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${l.checked}`]:{transform:"translateX(20px)"},[`&.${l.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${l.checked} + .${l.track}`]:{opacity:.5},[`&.${l.disabled} + .${l.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${l.input}`]:{left:"-100%",width:"300%"}}),({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:z(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(([,a])=>a.main&&a.light).map(([a])=>({props:{color:a},style:{[`&.${l.checked}`]:{color:(e.vars||e).palette[a].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[a].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:z(e.palette[a].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${l.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${a}DisabledColor`]:`${e.palette.mode==="light"?F(e.palette[a].main,.62):B(e.palette[a].main,.55)}`}},[`&.${l.checked} + .${l.track}`]:{backgroundColor:(e.vars||e).palette[a].main}}}))]})),ee=w("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,a)=>a.track})(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`})),te=w("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,a)=>a.thumb})(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),ae=h.forwardRef(function(a,i){const c=K({props:a,name:"MuiSwitch"}),{className:o,color:d="primary",edge:s=!1,size:v="medium",sx:n}=c,f=A(c,q),r=N({},c,{color:d,edge:s,size:v}),u=Q(r),p=t.jsx(te,{className:u.thumb,ownerState:r});return t.jsxs(Y,{className:W(u.root,o),sx:n,ownerState:r,children:[t.jsx(Z,N({type:"checkbox",icon:p,checkedIcon:p,ref:i,ownerState:r},f,{classes:N({},u,{root:u.switchBase})})),t.jsx(ee,{className:u.track,ownerState:r})]})}),se=({user:e,setUser:a,loading:i,error:c})=>{const[o,d]=h.useState(!1),[s,v]=h.useState(e),[n,f]=h.useState({open:!1,message:"",severity:""}),r=g=>{const{name:$,value:m}=g.target;v(j=>({...j,[$]:m}))},u=()=>{d(!0),v(e)},p=()=>{d(!1),v(e)},C=async()=>{try{const g=await D.patch(`http://localhost:3008/users/${e._id}`,s);g.status===200?(a(g.data),d(!1),f({open:!0,message:"User updated successfully.",severity:"success"}),setTimeout(()=>{window.location.reload()},2e3)):(console.error("Unexpected response status:",g.status),f({open:!0,message:"Unexpected response status.",severity:"error"}))}catch(g){console.error("Failed to update user:",g.message),f({open:!0,message:"Failed to update user.",severity:"error"})}},S=()=>{f({...n,open:!1})};return i?t.jsx("div",{className:"Loading",children:t.jsx(L,{})}):c?t.jsxs(I,{color:"error",children:["Error: ",c]}):t.jsxs("div",{className:"UserRight DisplayFlex",children:[t.jsx("span",{children:"User Details"}),t.jsxs("div",{className:"UserDetails DisplayFlex",children:[t.jsx(y,{id:"name",label:"Name",name:"name",type:"text",variant:"outlined",value:(s==null?void 0:s.name)||"",onChange:r,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!o}),t.jsx(y,{id:"phone",label:"Phone",name:"phone",type:"text",variant:"outlined",value:(s==null?void 0:s.phone)||"",onChange:r,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!o})]}),t.jsxs("div",{className:"UserDetails DisplayFlex",children:[t.jsx(y,{id:"email",label:"Email",name:"email",type:"text",variant:"outlined",value:(s==null?void 0:s.email)||"",onChange:r,fullWidth:!0,InputLabelProps:{shrink:!0},disabled:!o}),t.jsxs(y,{id:"userType",label:"Role",name:"userType",variant:"outlined",value:(s==null?void 0:s.userType)||"",onChange:r,fullWidth:!0,InputLabelProps:{shrink:!0},select:!0,disabled:!o,children:[t.jsx(b,{value:"admin",children:"Admin"}),t.jsx(b,{value:"user",children:"User"}),t.jsx(b,{value:"moderator",children:"Moderator"}),t.jsx(b,{value:"subscriber",children:"Subscriber"}),t.jsx(b,{value:"guest",children:"Guest"})]})]}),t.jsxs("div",{className:"UserDetails DisplayFlex",children:[t.jsxs(y,{id:"status",label:"Status",name:"status",variant:"outlined",value:(s==null?void 0:s.verificationStatus)||"",onChange:r,fullWidth:!0,InputLabelProps:{shrink:!0},select:!0,disabled:!o,children:[t.jsx(b,{value:"verified",children:"Verified"}),t.jsx(b,{value:"pending",children:"Pending"}),t.jsx(b,{value:"terminated",children:"Terminated"})]}),t.jsx(y,{id:"joined",label:"Joined",variant:"outlined",value:new Date(e==null?void 0:e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})||"",disabled:!0,fullWidth:!0,InputLabelProps:{shrink:!0}})]}),t.jsx("div",{className:"UserDetails DisplayFlex",children:t.jsx(y,{id:"description",label:"Description",name:"description",variant:"outlined",value:(s==null?void 0:s.description)||"",onChange:r,fullWidth:!0,InputLabelProps:{shrink:!0},multiline:!0,rows:4,disabled:!o})}),t.jsx("div",{className:"UserButtons DisplayFlex",children:o?t.jsxs(t.Fragment,{children:[t.jsx(M,{text:"Cancel",variant:"outlined",onClick:p,size:"small",sx:{marginRight:"10px",color:"var(--error-light)",border:"1.5px solid var(--error-light)","&:hover":{backgroundColor:"transparent !important",color:"var(--error-dark)",border:"1.5px solid var(--error-dark)"}}}),t.jsx(M,{text:"Update",variant:"contained",onClick:C,size:"small",sx:{color:"#fff",backgroundColor:"var(--success-darker)","&:hover":{backgroundColor:"var(--success-dark) !important",color:"var(--success-lighter)"}}})]}):t.jsx(M,{text:"Edit User",variant:"outlined",onClick:u,sx:{marginRight:"10px",color:"var(--primary-dark)",border:"1.5px solid var(--primary-dark)",Transition:"all 0.3s ease-in-out","&:hover":{backgroundColor:"transparent !important",color:"var(--primary-light)",border:"1.5px solid var(--primary-light)"}},size:"small"})}),t.jsx(T,{open:n.open,autoHideDuration:6e3,onClose:S,children:t.jsx(V,{onClose:S,severity:n.severity,sx:{width:"100%"},children:n.message})})]})},ie=w(e=>t.jsx(ae,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...e}))(({theme:e})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:e.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:e.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:e.palette.mode==="light"?"#E9E9EA":"#39393D",opacity:1,transition:e.transitions.create(["background-color"],{duration:500})}})),P=({user:e,loading:a,error:i,handleVerificationToggle:c,showVerificationInput:o,verificationCode:d,setVerificationCode:s,handleVerifyCode:v})=>{const[n,f]=h.useState({open:!1,message:"",severity:""}),r=()=>{f({...n,open:!1})};return a?t.jsx("div",{className:"Loading",children:t.jsx(L,{})}):i?t.jsxs(I,{color:"error",children:["Error: ",i]}):e?t.jsxs("div",{className:"UserLeft DisplayFlex",children:[t.jsx(G,{src:e.profilePicture,alt:e.name,style:{width:"8rem",height:"8rem"}}),t.jsxs("span",{children:[e.name," ",e.verificationStatus==="verified"&&t.jsx("i",{className:"fas fa-check-circle"})]}),t.jsx("p",{children:e.email}),t.jsxs("p",{children:[t.jsx("strong",{children:"Role:"})," ",e.userType]}),t.jsx("p",{children:new Date(e.lastLogin).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}),t.jsx(H,{control:t.jsx(ie,{checked:e.verificationStatus==="verified",onChange:c,disabled:e.verificationStatus==="verified"}),label:e.verificationStatus==="verified"?"Verified":"Verify",style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"1rem",fontSize:"0.8rem !important",fontWeight:"400 !important"}}),o&&t.jsx("div",{className:"VerificationInput",children:t.jsx(y,{placeholder:"Verification Code",value:d,onChange:u=>s(u.target.value),type:"text",variant:"outlined",InputProps:{endAdornment:t.jsx(M,{onClick:v,variant:"contained",color:"primary",size:"small",text:"Verify",disabled:a})}})}),t.jsx(T,{open:n.open,autoHideDuration:6e3,onClose:r,children:t.jsx(V,{onClose:r,severity:n.severity,sx:{width:"100%"},children:n.message})})]}):t.jsx("div",{children:"No user data available"})};P.propTypes={user:x.object,loading:x.bool,error:x.string,handleVerificationToggle:x.func,showVerificationInput:x.bool,verificationCode:x.string,setVerificationCode:x.func,handleVerifyCode:x.func};const pe=()=>{const{id:e}=X(),[a,i]=h.useState(null),[c,o]=h.useState(!0),[d,s]=h.useState(null),[v,n]=h.useState(!1),[f,r]=h.useState(""),[u,p]=h.useState({open:!1,message:"",severity:""}),C=async()=>{try{const m=await D.get(`http://localhost:3008/users/${e}`);i(m.data),o(!1)}catch(m){s(m.message),o(!1)}};h.useEffect(()=>{C()},[e]);const S=async m=>{if(m.target.checked){n(!0);try{(await D.post("http://localhost:3008/users/send-verification",{email:a.email})).status===200?p({open:!0,message:"Verification link has been sent to your email.",severity:"success"}):p({open:!0,message:"Failed to send verification link.",severity:"error"})}catch{p({open:!0,message:"Failed to send verification link.",severity:"error"})}}},g=async()=>{try{(await D.post("http://localhost:3008/users/verify-code",{email:a.email,code:f})).status===200?(i(j=>({...j,verificationStatus:"verified"})),n(!1),p({open:!0,message:"Verification successful.",severity:"success"})):p({open:!0,message:"Verification failed.",severity:"error"})}catch{p({open:!0,message:"Verification failed.",severity:"error"})}},$=()=>{p({...u,open:!1})};return c?t.jsx("div",{className:"Loading",children:t.jsx("div",{className:"Spinner"})}):d?t.jsxs("div",{children:["Error: ",d]}):a?t.jsxs("div",{className:"User",children:[t.jsxs("div",{className:"UserContainer",children:[t.jsx(P,{user:a,fetchUser:C,loading:c,error:d,handleVerificationToggle:S,showVerificationInput:v,verificationCode:f,setVerificationCode:r,handleVerifyCode:g}),t.jsx(se,{user:a,setUser:i,loading:c,error:d})]}),t.jsx(T,{open:u.open,autoHideDuration:6e3,onClose:$,children:t.jsx(V,{onClose:$,severity:u.severity,sx:{width:"100%"},children:u.message})})]}):t.jsx("div",{children:"No user data available"})};export{pe as default};
