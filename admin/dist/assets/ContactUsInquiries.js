import{r as t,q as U,j as s,t as y,v,b as M,B as T}from"./index.js";import"./CustomTextField.js";import{C as k}from"./CustomTable.js";import{D as q,a as E,b as _,c as w}from"./DialogTitle.js";import"./CustomButton.js";import"./index.esm.js";import"./MenuItem.js";const J=()=>{var b;const[p,m]=t.useState(1),l=7,{contactUsInquiries:h}=t.useContext(U),[a,n]=t.useState(null),[x,o]=t.useState(""),[g,i]=t.useState(""),[j,r]=t.useState(null),[D,c]=t.useState(!1),S=()=>{m(e=>e+1)},I=()=>{m(e=>Math.max(e-1,1))},d=h.data.map(e=>({_id:e._id,name:e.name,email:e.email,phoneNo:e.phoneNo,message:e.message,subject:e.subject,status:e.status})),f=(p-1)*l,N=d==null?void 0:d.slice(f,f+l),P=[{label:"Inquiry_ID",field:"_id"},{label:"Name",field:"name"},{label:"Email",field:"email"},{label:"Subject",field:"subject"},{label:"Message",field:"message"},{label:"Status",field:"status"}],R=e=>{n(e),c(!0)},F=async()=>{if(!a)return;const e=new FormData;e.append("email",a.email),e.append("subject",g),e.append("reply",x),j&&e.append("attachment",j);try{await M.post("http://localhost:5000/api/v1/sendReply",e,{headers:{"Content-Type":"multipart/form-data"}}).then(u=>{u.status===200&&T.success("Reply sent successfully	")}),o(""),i(""),r(null),n(null),c(!1)}catch(u){console.error("Error sending reply:",u),alert("Failed to send reply.")}},C=()=>{c(!1),n(null),o(""),i(""),r(null)};return s.jsxs("div",{className:"ContactUsInquiries DisplayFlex",children:[s.jsxs("div",{className:"Header",children:[s.jsx("span",{children:"Dashboard"})," ",s.jsx("i",{className:"fas fa-angle-right"})," ",s.jsx("span",{children:"Contact Us Inquiries"})]}),s.jsxs("div",{className:"ContactUsInquiriesContainer DisplayFlex",children:[s.jsx("div",{className:"ContactUsInquiriesTop DisplayFlex",children:s.jsx("div",{className:"Filter DisplayFlex"})}),s.jsx("div",{className:"ContactUsInquiriesBottom",children:s.jsx(k,{data:N,columns:P,currentPage:p,totalItems:(b=h.data)==null?void 0:b.length,usersPerPage:l,handleNextPage:S,handlePreviousPage:I,context:"contactUsInquiries",onReplyClick:R})})]}),s.jsxs(q,{open:D,onClose:C,children:[s.jsxs(E,{children:["Reply to ",a==null?void 0:a.email]}),s.jsxs(_,{children:[s.jsx(y,{label:"Subject",fullWidth:!0,value:g,onChange:e=>i(e.target.value),variant:"outlined",margin:"dense"}),s.jsx(y,{label:"Reply Message",multiline:!0,rows:4,fullWidth:!0,value:x,onChange:e=>o(e.target.value),variant:"outlined",margin:"dense"}),s.jsx("input",{type:"file",onChange:e=>r(e.target.files[0])})]}),s.jsxs(w,{children:[s.jsx(v,{onClick:C,color:"secondary",children:"Cancel"}),"     ",s.jsx(v,{onClick:F,color:"primary",children:"Send Reply"})]})]})]})};export{J as default};
